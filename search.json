[
  {
    "objectID": "src/documentation/elasticsearch.html",
    "href": "src/documentation/elasticsearch.html",
    "title": "Identification dâ€™adresse",
    "section": "",
    "text": "Lâ€™objectif est de founir un service qui prend une adresse en entrÃ©e (couple string adresse/string code insee), et renvoie un identifiant GaÃ¯a le plus prÃ©cis possible et des informations sur la qualitÃ© de lâ€™identification. Il y a 3 niveaux dâ€™identifiants GaÃ¯a :\n- IdGaÃ¯aAdresse (le plus prÃ©cis)\n- IdGaÃ¯aVoie (lorsque le numÃ©ro nâ€™est pas retrouvÃ©, mais que la voie si)\n- idGaÃ¯aCommune (lorsque ni lâ€™adresse, ni la voie ne sont identifiÃ©es)\nExemple : {â€œadresseCompleteâ€: â€œ131 rue du faubourg bannierâ€, â€œdepcomâ€: â€œ45324â€}.\nLe depcom est le Code Officiel GÃ©ographique de la commune.\n\n\n\nSchÃ©ma algorithme dâ€™identification dâ€™adresse avec ElasticSearch\n\n\n\n\nIl existe deux indices : adresses contenant toutes les adresses fraÃ§aises et voies contenant toutes les voies fraÃ§aises.\nExemple : une adresse est â€œ20 rue hocheâ€ et une voie est â€œrue hocheâ€.\nLa premiÃ¨re Ã©tape est la recherche stricte de lâ€™adresse recherchÃ©e dans lâ€™index adresses sur les adresses de la commune uniquement.\nSi aucun IdGaÃ¯aAdresse ne ressort Ã  lâ€™issue de lâ€™Ã©tape 1, alors :\n- Recherche floue dans lâ€™index voies sur les adresses de la commune uniquement, pour retrouver lâ€™IdGaÃ¯aVoie (Ã©tape 2).\n- Recherche dans lâ€™index adresses sur les adresses de la voie trouvÃ©e Ã  lâ€™Ã©tape 1 uniquement, pour retrouver lâ€™idGaÃ¯aAdresse (Ã©tape 3).\nLa qualitÃ© globale de lâ€™appariement est apprÃ©ciÃ©e au travers de deux indicateurs : un code retour qui donne, sur une Ã©chelle de 0 Ã  10, une vision globale sur le retour de lâ€™algorithme et un score relatif pour repÃ©rer dâ€™Ã©ventuelles concurrences entre rÃ©ponses de qualitÃ© proche.\n\n\nLâ€™information principale est fournie par un code retour, qui vise Ã  indiquer les Ã©lÃ©ments qui ont Ã©tÃ© identifiÃ©s dans le processus dâ€™appariement.\nLâ€™algorithme recherche dâ€™abord la commune indiquÃ©e (pour lâ€™instant cette Ã©tape nâ€™est pas faite avec ElasticSearch), puis la voie au sein de la commune et enfin lâ€™adresse dans la voie, câ€™est-Ã -dire lâ€™existence du numÃ©ro et de lâ€™indice de rÃ©pÃ©tition dans les adresses de la voie.\nLa voie retrouvÃ©e est typÃ©e selon quatre catÃ©gories, en fonction du nombre de trigrammes retrouvÃ©s :\n\nvoie sÃ»re : lâ€™adresse contient plus de 65 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nvoie peu douteuse : lâ€™adresse contient entre 35 % et 65 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nvoie douteuse : lâ€™adresse contient entre 10 % et 35 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nvoie non retrouvÃ©e : pas dâ€™Ã©cho ou lâ€™adresse contient moins de 10 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nEn ce qui concerne les adresses, les contrÃ´les portent sur le numÃ©ro et lâ€™indice de rÃ©pÃ©tition :\n\nSi lâ€™adresse demandÃ©e ne contient pas dâ€™indice de rÃ©pÃ©tition et que le numÃ©ro est trouvÃ©, alors lâ€™adresse est sÃ»re.\n\nSi lâ€™adresse demandÃ©e contient un indice de rÃ©pÃ©tition et sâ€™il est retrouvÃ©, lâ€™adresse est sÃ»re.\n\nSi lâ€™adresse demandÃ©e contient un indice de rÃ©pÃ©tition mais quâ€™il nâ€™est pas retrouvÃ©, alors lâ€™adresse est douteuse.\n\nSi le numÃ©ro nâ€™est pas retrouvÃ© exactement, aucune adresse nâ€™est retournÃ©e.\n\nSi une voie est douteuse, alors la qualitÃ© de lâ€™adresse globale est douteuse : on ne distingue donc pas les cas oÃ¹ lâ€™adresse est sÃ»re et douteuse.\n\n\n\n\n\n\n\n\n\nAdresse\nVoie\nCode_retour\nLibellÃ©\n\n\n\n\nsÃ»re\nsÃ»re\n10\nAppariement direct sur lâ€™adresse\n\n\nsÃ»re\nsÃ»re\n9\nAdresse sÃ»re\n\n\ndouteuse\nsÃ»re\n8\nAdresse douteuse dans voie sÃ»re\n\n\nsÃ»re & douteuse\ndouteuse\n7\nAdresse dans voie douteuse\n\n\nsÃ»re & douteuse\ntrÃ¨s douteuse\n6\nAdresse dans voie trÃ¨s douteuse\n\n\npas dâ€™adresse trouvÃ©e\nsÃ»re\n5\nVoie sÃ»re sans adresse\n\n\npas dâ€™adresse trouvÃ©e\ndouteuse\n4\nVoie douteuse sans adresse\n\n\npas dâ€™adresse trouvÃ©e\ntrÃ¨s douteuse\n3\nVoie trÃ¨s douteuse sans adresse\n\n\npas dâ€™adresse trouvÃ©e\npas de voie trouvÃ©e\n2\nCommune seulement\n\n\npas dâ€™adresse trouvÃ©e\npas de voie trouvÃ©e\n1\nAdresse Ã  lâ€™Ã©tranger\n\n\npas dâ€™adresse trouvÃ©e\npas de voie trouvÃ©e\n0\nProblÃ¨me dans les donnÃ©es (par exemple, commune non trouvÃ©e)\n\n\n\n\n\n\nLâ€™objectif de cette information complÃ©mentaire est dâ€™indiquer la position de lâ€™Ã©cho retournÃ© par rapport aux autres Ã©chos possibles dans lâ€™index voies, lors de la requÃªte Ã  lâ€™Ã©tape 2. Il permet dâ€™Ã©valuer si le score Elastic du premier Ã©cho (notÃ© R1) est bien supÃ©rieur au score du second (notÃ© R2).\nLa formule du ratio est 1-(R2/R1) ; si le score est supÃ©rieur Ã  0,9999, il est ramenÃ© Ã  0,9999.\nSi la valeur est proche de 1, alors le premier Ã©cho se dÃ©tache nettement des autres et donc la recherche est sans ambiguÃ¯tÃ©. A lâ€™inverse, si la valeur est proche de 0, alors le premier et le second Ã©cho ont le mÃªme score et la recherche aurait donc pu retourner un autre rÃ©sultat.\nLe score relatif est compris entre 0 et 1 et donnÃ© avec 4 dÃ©cimales. Le score maximal est de 0,9999, afin de pouvoir Ãªtre utilisÃ© en combinaison avec le code retour.\n\n\n\n\nLa logique globale de lâ€™algorithme est la suivante :\n\nOn va enchaÃ®ner des Ã©tapes de contrÃ´les, dâ€™interrogation dâ€™ElasticSearch, de rÃ¨gles de dÃ©cision.\n\nA chaque Ã©tape, il est possible dâ€™attribuer un code retour â€œsortantâ€ Ã  lâ€™adresse quâ€™on souhaite identifier. Par exemple, si lâ€™adresse est vide, on attribue un code retour 0 et lâ€™adresse ne va pas plus loin dans lâ€™algorithme.\n\nSi lâ€™adresse nâ€™a pas de code retour attribuÃ©, alors on continue dans lâ€™algorithme.\n\nComme prÃ©cisÃ© plus haut, lâ€™algorithme marche en 4 Ã©tapes dâ€™identification: commune â€”&gt; adresse exacte â€“si pas de match-&gt; voie â€”&gt; adresse\n\n\nLes donnÃ©es du client et dans lâ€™index sont traitÃ©es de la mÃªme faÃ§on pour maximiser les matchs :\n- Lowercase\n- Asciifolding\n- Traitement de la ponctuation\n- Utilisation de listes de synonymes\n\n\n\nLâ€™identification Ã  la commune se fait Ã  travers un dictionnaire, pour rÃ©cupÃ©rer lâ€™idGaÃ¯aCommune et passer Ã  lâ€™Ã©tape suivante.\n\n\n\nAfin dâ€™accÃ©lerer notre procÃ©dure dâ€™identification, une requÃªte simple et rapide nous permet dâ€™identifier une adresse si son orthographe est parfaite. Cette requÃªte consiste Ã  rechercher au sein des adresses de la commune identifiÃ©e Ã  lâ€™Ã©tape prÃ©cÃ©dente grÃ¢ce Ã  un filter sur lâ€™idGaÃ¯aCommune, les adresses dont la variable adresseComplete (string reprÃ©sentant lâ€™adresse contenant le numÃ©ro, lâ€™indice de rÃ©pÃ©tition, le type et le nom de voie) correspond parfaitement au string envoyÃ© par le client. Ceci est assurÃ© par le caractÃ¨re stricte de la requÃªte must, accompagnÃ© dâ€™un minimum_should_match=100%.\nPour gagner encore plus de temps, la variable adresseComplete ainsi que le string client ne sont pas dÃ©coupÃ©s en token, comme dans les rÃ©glages par dÃ©faut dâ€™ElasticSearch (le minimum should match est un seuil sur le nombre ou la proportion de bouts matchÃ©s entre le rÃ©sultats de lâ€™index et la demande du client, et un bout peut Ãªtre le string complet, tout comme un token ou un ngram). Alors, le moteur va retourner lâ€™adresse qui est parfaitement incluse dans le string envoyÃ©.\nEn prÃ©sence dâ€™un rÃ©sultat Ã  cette requÃªte, le premier echo est conservÃ© avec un code retour 10 et lâ€™algorithme dâ€™identification se termine Ã  cette Ã©tape.\n\n\n\nLa requÃªte pour identifier Ã  la voie est plus complexe car elle inclut la possibilitÃ© dâ€™avoir du flou dans lâ€™adresse Ã  rechercher.\nPour faciliter la recherche, un filtre est appliquÃ© pour ne requÃªter que les voies dans la commune identifiÃ©e Ã  lâ€™Ã©tape 0.\nCâ€™est une succession de should oÃ¹ au moins lâ€™un dâ€™entre eux doit Ãªtre validÃ© pour que la voie soit renvoyÃ©e :\n- Le nom de voie dans lâ€™index non tokenisÃ© est matchÃ© avec une fuzziness de 1 (boost : 200)\n- Le type de voie et/ou le nom de voie du rÃ©fÃ©rentiel sont inclus dans lâ€™adresse client avec une fuzziness de 1 (boosts respectifs : 5 et 15)\n- Au moins un ngram du nom de voie de lâ€™index, de taille 3 Ã  5, correspond (boost par ngram : 1)\nEnsuite, une multitude de vÃ©rifications sont appliquÃ©es sur le premier echo (sâ€™il existe), qui va dÃ©terminer si la voie est sÃ»re, peu douteuse, douteuse ou non retrouvÃ©e (citÃ©es plus haut).\nSâ€™il nâ€™y a pas de retour ElasticSearch ou si la voie est jugÃ©e comme non retrouvÃ©e dâ€™aprÃ¨s les rÃ¨gles, un code retour 2 sera affichÃ©.\n\n\n\nPour retrouver lâ€™adresse Ã  partir de la voie, nous allons chercher dans les adresses de la voie identifiÃ©e Ã  lâ€™Ã©tape 2 (avec un filter sur idGaÃ¯aVoie) et demander Ã  matcher sur les champs numÃ©ro et/ou indice de rÃ©pÃ©tition dans notre base.\nDes regex ont Ã©tÃ© dÃ©veloppÃ©es pour extraire le numÃ©ro de lâ€™adresse dans le string client et qui dÃ©tecte la prÃ©sence dâ€™indice de rÃ©pÃ©tition dans celle-ci. Ensuite, un must est appliquÃ© sur le champ numÃ©ro avec lâ€™extraction du numÃ©ro. Si lâ€™extraction ne retourne rien, le numÃ©ro recherchÃ© par le must sera alors â€œ0â€. Lâ€™indice de rÃ©pÃ©tition sera recherchÃ© avec un should.\nSi le moteur retourne plusieurs adresses, lâ€™adresse retournÃ©e sera :\n- celle qui a un indice de rÃ©pÃ©tition si un indice a Ã©tÃ© dÃ©tectÃ© dans lâ€™adresse recherchÃ©e\n- celle qui nâ€™a pas dâ€™indice de rÃ©pÃ©tition si aucun indice nâ€™a Ã©tÃ© dÃ©tectÃ© dans lâ€™adresse recherchÃ©e\nDans le cas oÃ¹ un idGaÃ¯aAdresse est trouvÃ©, il sera accompagnÃ© dâ€™un code retour 7, 8 ou 9.\nFinalement, dans le cas oÃ¹ aucune adresse ne ressort, alors un code retour 3, 4 ou 5 sera attribuÃ© en fonction de la fiabilitÃ© de la voie identifiÃ©e.",
    "crumbs": [
      "Accueil",
      "Navigation",
      "Identification d'adresse avec ElasticSearch"
    ]
  },
  {
    "objectID": "src/documentation/elasticsearch.html#fonctionnement-de-lidentification",
    "href": "src/documentation/elasticsearch.html#fonctionnement-de-lidentification",
    "title": "Identification dâ€™adresse",
    "section": "",
    "text": "Il existe deux indices : adresses contenant toutes les adresses fraÃ§aises et voies contenant toutes les voies fraÃ§aises.\nExemple : une adresse est â€œ20 rue hocheâ€ et une voie est â€œrue hocheâ€.\nLa premiÃ¨re Ã©tape est la recherche stricte de lâ€™adresse recherchÃ©e dans lâ€™index adresses sur les adresses de la commune uniquement.\nSi aucun IdGaÃ¯aAdresse ne ressort Ã  lâ€™issue de lâ€™Ã©tape 1, alors :\n- Recherche floue dans lâ€™index voies sur les adresses de la commune uniquement, pour retrouver lâ€™IdGaÃ¯aVoie (Ã©tape 2).\n- Recherche dans lâ€™index adresses sur les adresses de la voie trouvÃ©e Ã  lâ€™Ã©tape 1 uniquement, pour retrouver lâ€™idGaÃ¯aAdresse (Ã©tape 3).\nLa qualitÃ© globale de lâ€™appariement est apprÃ©ciÃ©e au travers de deux indicateurs : un code retour qui donne, sur une Ã©chelle de 0 Ã  10, une vision globale sur le retour de lâ€™algorithme et un score relatif pour repÃ©rer dâ€™Ã©ventuelles concurrences entre rÃ©ponses de qualitÃ© proche.\n\n\nLâ€™information principale est fournie par un code retour, qui vise Ã  indiquer les Ã©lÃ©ments qui ont Ã©tÃ© identifiÃ©s dans le processus dâ€™appariement.\nLâ€™algorithme recherche dâ€™abord la commune indiquÃ©e (pour lâ€™instant cette Ã©tape nâ€™est pas faite avec ElasticSearch), puis la voie au sein de la commune et enfin lâ€™adresse dans la voie, câ€™est-Ã -dire lâ€™existence du numÃ©ro et de lâ€™indice de rÃ©pÃ©tition dans les adresses de la voie.\nLa voie retrouvÃ©e est typÃ©e selon quatre catÃ©gories, en fonction du nombre de trigrammes retrouvÃ©s :\n\nvoie sÃ»re : lâ€™adresse contient plus de 65 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nvoie peu douteuse : lâ€™adresse contient entre 35 % et 65 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nvoie douteuse : lâ€™adresse contient entre 10 % et 35 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nvoie non retrouvÃ©e : pas dâ€™Ã©cho ou lâ€™adresse contient moins de 10 % des trigrammes de la voie du rÃ©fÃ©rentiel\n\nEn ce qui concerne les adresses, les contrÃ´les portent sur le numÃ©ro et lâ€™indice de rÃ©pÃ©tition :\n\nSi lâ€™adresse demandÃ©e ne contient pas dâ€™indice de rÃ©pÃ©tition et que le numÃ©ro est trouvÃ©, alors lâ€™adresse est sÃ»re.\n\nSi lâ€™adresse demandÃ©e contient un indice de rÃ©pÃ©tition et sâ€™il est retrouvÃ©, lâ€™adresse est sÃ»re.\n\nSi lâ€™adresse demandÃ©e contient un indice de rÃ©pÃ©tition mais quâ€™il nâ€™est pas retrouvÃ©, alors lâ€™adresse est douteuse.\n\nSi le numÃ©ro nâ€™est pas retrouvÃ© exactement, aucune adresse nâ€™est retournÃ©e.\n\nSi une voie est douteuse, alors la qualitÃ© de lâ€™adresse globale est douteuse : on ne distingue donc pas les cas oÃ¹ lâ€™adresse est sÃ»re et douteuse.\n\n\n\n\n\n\n\n\n\nAdresse\nVoie\nCode_retour\nLibellÃ©\n\n\n\n\nsÃ»re\nsÃ»re\n10\nAppariement direct sur lâ€™adresse\n\n\nsÃ»re\nsÃ»re\n9\nAdresse sÃ»re\n\n\ndouteuse\nsÃ»re\n8\nAdresse douteuse dans voie sÃ»re\n\n\nsÃ»re & douteuse\ndouteuse\n7\nAdresse dans voie douteuse\n\n\nsÃ»re & douteuse\ntrÃ¨s douteuse\n6\nAdresse dans voie trÃ¨s douteuse\n\n\npas dâ€™adresse trouvÃ©e\nsÃ»re\n5\nVoie sÃ»re sans adresse\n\n\npas dâ€™adresse trouvÃ©e\ndouteuse\n4\nVoie douteuse sans adresse\n\n\npas dâ€™adresse trouvÃ©e\ntrÃ¨s douteuse\n3\nVoie trÃ¨s douteuse sans adresse\n\n\npas dâ€™adresse trouvÃ©e\npas de voie trouvÃ©e\n2\nCommune seulement\n\n\npas dâ€™adresse trouvÃ©e\npas de voie trouvÃ©e\n1\nAdresse Ã  lâ€™Ã©tranger\n\n\npas dâ€™adresse trouvÃ©e\npas de voie trouvÃ©e\n0\nProblÃ¨me dans les donnÃ©es (par exemple, commune non trouvÃ©e)\n\n\n\n\n\n\nLâ€™objectif de cette information complÃ©mentaire est dâ€™indiquer la position de lâ€™Ã©cho retournÃ© par rapport aux autres Ã©chos possibles dans lâ€™index voies, lors de la requÃªte Ã  lâ€™Ã©tape 2. Il permet dâ€™Ã©valuer si le score Elastic du premier Ã©cho (notÃ© R1) est bien supÃ©rieur au score du second (notÃ© R2).\nLa formule du ratio est 1-(R2/R1) ; si le score est supÃ©rieur Ã  0,9999, il est ramenÃ© Ã  0,9999.\nSi la valeur est proche de 1, alors le premier Ã©cho se dÃ©tache nettement des autres et donc la recherche est sans ambiguÃ¯tÃ©. A lâ€™inverse, si la valeur est proche de 0, alors le premier et le second Ã©cho ont le mÃªme score et la recherche aurait donc pu retourner un autre rÃ©sultat.\nLe score relatif est compris entre 0 et 1 et donnÃ© avec 4 dÃ©cimales. Le score maximal est de 0,9999, afin de pouvoir Ãªtre utilisÃ© en combinaison avec le code retour.",
    "crumbs": [
      "Accueil",
      "Navigation",
      "Identification d'adresse avec ElasticSearch"
    ]
  },
  {
    "objectID": "src/documentation/elasticsearch.html#algorithme-didentification",
    "href": "src/documentation/elasticsearch.html#algorithme-didentification",
    "title": "Identification dâ€™adresse",
    "section": "",
    "text": "La logique globale de lâ€™algorithme est la suivante :\n\nOn va enchaÃ®ner des Ã©tapes de contrÃ´les, dâ€™interrogation dâ€™ElasticSearch, de rÃ¨gles de dÃ©cision.\n\nA chaque Ã©tape, il est possible dâ€™attribuer un code retour â€œsortantâ€ Ã  lâ€™adresse quâ€™on souhaite identifier. Par exemple, si lâ€™adresse est vide, on attribue un code retour 0 et lâ€™adresse ne va pas plus loin dans lâ€™algorithme.\n\nSi lâ€™adresse nâ€™a pas de code retour attribuÃ©, alors on continue dans lâ€™algorithme.\n\nComme prÃ©cisÃ© plus haut, lâ€™algorithme marche en 4 Ã©tapes dâ€™identification: commune â€”&gt; adresse exacte â€“si pas de match-&gt; voie â€”&gt; adresse\n\n\nLes donnÃ©es du client et dans lâ€™index sont traitÃ©es de la mÃªme faÃ§on pour maximiser les matchs :\n- Lowercase\n- Asciifolding\n- Traitement de la ponctuation\n- Utilisation de listes de synonymes\n\n\n\nLâ€™identification Ã  la commune se fait Ã  travers un dictionnaire, pour rÃ©cupÃ©rer lâ€™idGaÃ¯aCommune et passer Ã  lâ€™Ã©tape suivante.\n\n\n\nAfin dâ€™accÃ©lerer notre procÃ©dure dâ€™identification, une requÃªte simple et rapide nous permet dâ€™identifier une adresse si son orthographe est parfaite. Cette requÃªte consiste Ã  rechercher au sein des adresses de la commune identifiÃ©e Ã  lâ€™Ã©tape prÃ©cÃ©dente grÃ¢ce Ã  un filter sur lâ€™idGaÃ¯aCommune, les adresses dont la variable adresseComplete (string reprÃ©sentant lâ€™adresse contenant le numÃ©ro, lâ€™indice de rÃ©pÃ©tition, le type et le nom de voie) correspond parfaitement au string envoyÃ© par le client. Ceci est assurÃ© par le caractÃ¨re stricte de la requÃªte must, accompagnÃ© dâ€™un minimum_should_match=100%.\nPour gagner encore plus de temps, la variable adresseComplete ainsi que le string client ne sont pas dÃ©coupÃ©s en token, comme dans les rÃ©glages par dÃ©faut dâ€™ElasticSearch (le minimum should match est un seuil sur le nombre ou la proportion de bouts matchÃ©s entre le rÃ©sultats de lâ€™index et la demande du client, et un bout peut Ãªtre le string complet, tout comme un token ou un ngram). Alors, le moteur va retourner lâ€™adresse qui est parfaitement incluse dans le string envoyÃ©.\nEn prÃ©sence dâ€™un rÃ©sultat Ã  cette requÃªte, le premier echo est conservÃ© avec un code retour 10 et lâ€™algorithme dâ€™identification se termine Ã  cette Ã©tape.\n\n\n\nLa requÃªte pour identifier Ã  la voie est plus complexe car elle inclut la possibilitÃ© dâ€™avoir du flou dans lâ€™adresse Ã  rechercher.\nPour faciliter la recherche, un filtre est appliquÃ© pour ne requÃªter que les voies dans la commune identifiÃ©e Ã  lâ€™Ã©tape 0.\nCâ€™est une succession de should oÃ¹ au moins lâ€™un dâ€™entre eux doit Ãªtre validÃ© pour que la voie soit renvoyÃ©e :\n- Le nom de voie dans lâ€™index non tokenisÃ© est matchÃ© avec une fuzziness de 1 (boost : 200)\n- Le type de voie et/ou le nom de voie du rÃ©fÃ©rentiel sont inclus dans lâ€™adresse client avec une fuzziness de 1 (boosts respectifs : 5 et 15)\n- Au moins un ngram du nom de voie de lâ€™index, de taille 3 Ã  5, correspond (boost par ngram : 1)\nEnsuite, une multitude de vÃ©rifications sont appliquÃ©es sur le premier echo (sâ€™il existe), qui va dÃ©terminer si la voie est sÃ»re, peu douteuse, douteuse ou non retrouvÃ©e (citÃ©es plus haut).\nSâ€™il nâ€™y a pas de retour ElasticSearch ou si la voie est jugÃ©e comme non retrouvÃ©e dâ€™aprÃ¨s les rÃ¨gles, un code retour 2 sera affichÃ©.\n\n\n\nPour retrouver lâ€™adresse Ã  partir de la voie, nous allons chercher dans les adresses de la voie identifiÃ©e Ã  lâ€™Ã©tape 2 (avec un filter sur idGaÃ¯aVoie) et demander Ã  matcher sur les champs numÃ©ro et/ou indice de rÃ©pÃ©tition dans notre base.\nDes regex ont Ã©tÃ© dÃ©veloppÃ©es pour extraire le numÃ©ro de lâ€™adresse dans le string client et qui dÃ©tecte la prÃ©sence dâ€™indice de rÃ©pÃ©tition dans celle-ci. Ensuite, un must est appliquÃ© sur le champ numÃ©ro avec lâ€™extraction du numÃ©ro. Si lâ€™extraction ne retourne rien, le numÃ©ro recherchÃ© par le must sera alors â€œ0â€. Lâ€™indice de rÃ©pÃ©tition sera recherchÃ© avec un should.\nSi le moteur retourne plusieurs adresses, lâ€™adresse retournÃ©e sera :\n- celle qui a un indice de rÃ©pÃ©tition si un indice a Ã©tÃ© dÃ©tectÃ© dans lâ€™adresse recherchÃ©e\n- celle qui nâ€™a pas dâ€™indice de rÃ©pÃ©tition si aucun indice nâ€™a Ã©tÃ© dÃ©tectÃ© dans lâ€™adresse recherchÃ©e\nDans le cas oÃ¹ un idGaÃ¯aAdresse est trouvÃ©, il sera accompagnÃ© dâ€™un code retour 7, 8 ou 9.\nFinalement, dans le cas oÃ¹ aucune adresse ne ressort, alors un code retour 3, 4 ou 5 sera attribuÃ© en fonction de la fiabilitÃ© de la voie identifiÃ©e.",
    "crumbs": [
      "Accueil",
      "Navigation",
      "Identification d'adresse avec ElasticSearch"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Moteur de recherche dâ€™adresses GaÃ¯a",
    "section": "",
    "text": "Moteur de recherche dâ€™adresses GaÃ¯a\n\n\n\n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            Documentation\n            \n\n            \n              Description : Ici est rassemblÃ©e toute la documentation technique sur le moteur de recherche d'adresse textuel GaÃ¯a\n\n            \n\n            \n            \n              \n                Raya Berova\n                Nov 27, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        doc\n                      \n                    \n                  \n                \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            SÃ©minaire interne DMS\n            \n\n            \n              Description : Ce sÃ©minaire a pour but de prÃ©senter le moteur de recherche d'adresse GaÃ¯a et de diffuser les connaissances sur ElasticSearch au sein de l'Insee.\n\n            \n\n            \n            \n              \n                Raya Berova\n                Nov 27, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        pdf\n                      \n                    \n                  \n                \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n  \n     \n      \n        \n          \n            \n          \n         \n        \n          \n            Abstract NTTS 2025 (Eurostat)\n            \n\n            \n              Description : Abstract en anglais soumis Ã  NTTS 2025.\n\n            \n\n            \n            \n              \n                Raya Berova\n                Nov 27, 2024\n              \n            \n            \n            \n              \n                \n                  \n                    \n                      \n                        pdf\n                      \n                    \n                  \n                \n              \n            \n          \n        \n\n        \n\n      \n     \n  \n\n\n\n\nNo matching items"
  },
  {
    "objectID": "src/documentation/index.html",
    "href": "src/documentation/index.html",
    "title": "Accueil de la documentation",
    "section": "",
    "text": "Informations de connexion via Filezilla en protocole FTP (connexion FTP simple)\n\n\n\n\n\n\n\n\nPlateforme\nURL\nVM\n\n\n\n\nDV\nhttps://api-interrogation-geo.developpement.insee.fr/swagger-ui/index.html\ndvgaialm001\n\n\nDV2\nhttps://api-interrogation-geo.developpement2.insee.fr/swagger-ui/index.html\ndvgaialm002\n\n\nPREPROD\nhttps://api-interrogation-geo.preprod.insee.fr/swagger-ui/index.html\npdgaialm001/2/3\n\n\nPROD\nhttps://api-interrogation-geo.insee.fr/swagger-ui/index.html\npdgaialm001/2/3\n\n\n\nPour requÃªter le service dâ€™identification, il faut que lâ€™utilisateur soit authentifiÃ© en ayant rÃ©cupÃ©rÃ© un jeton Keycloak au prÃ©alable et quâ€™il bÃ©nÃ©ficie du rÃ´le IDENTIFICATION_GAIA. Si ce nâ€™est pas le cas, contactez lâ€™Ã©quipe GaÃ¯a sur Tchap ou mail.\n\n\n\nPour lancer une identification avec le moteur ElasticSearch dÃ©veloppÃ© en python, il faut aller sur le dÃ©pÃ´t git et lire le README. Il est possible dâ€™accÃ©der au dÃ©pÃ´t en cliquant ici Moteur de recherche GaÃ¯a. Puis aller sur LS3 pour cloner le projet.\nâš ï¸ Attention : il faut avoir les droits pour accÃ©der au dÃ©pÃ´t et Ãªtre dans le projet LS3. Si ce nâ€™est pas le cas, contactez lâ€™Ã©quipe GaÃ¯a sur Tchap ou mail.",
    "crumbs": [
      "Accueil",
      "Navigation",
      "Accueil"
    ]
  },
  {
    "objectID": "src/documentation/index.html#recherche-simple-les-swaggers",
    "href": "src/documentation/index.html#recherche-simple-les-swaggers",
    "title": "Accueil de la documentation",
    "section": "",
    "text": "Informations de connexion via Filezilla en protocole FTP (connexion FTP simple)\n\n\n\n\n\n\n\n\nPlateforme\nURL\nVM\n\n\n\n\nDV\nhttps://api-interrogation-geo.developpement.insee.fr/swagger-ui/index.html\ndvgaialm001\n\n\nDV2\nhttps://api-interrogation-geo.developpement2.insee.fr/swagger-ui/index.html\ndvgaialm002\n\n\nPREPROD\nhttps://api-interrogation-geo.preprod.insee.fr/swagger-ui/index.html\npdgaialm001/2/3\n\n\nPROD\nhttps://api-interrogation-geo.insee.fr/swagger-ui/index.html\npdgaialm001/2/3\n\n\n\nPour requÃªter le service dâ€™identification, il faut que lâ€™utilisateur soit authentifiÃ© en ayant rÃ©cupÃ©rÃ© un jeton Keycloak au prÃ©alable et quâ€™il bÃ©nÃ©ficie du rÃ´le IDENTIFICATION_GAIA. Si ce nâ€™est pas le cas, contactez lâ€™Ã©quipe GaÃ¯a sur Tchap ou mail.",
    "crumbs": [
      "Accueil",
      "Navigation",
      "Accueil"
    ]
  },
  {
    "objectID": "src/documentation/index.html#recherche-avancÃ©e-code-python",
    "href": "src/documentation/index.html#recherche-avancÃ©e-code-python",
    "title": "Accueil de la documentation",
    "section": "",
    "text": "Pour lancer une identification avec le moteur ElasticSearch dÃ©veloppÃ© en python, il faut aller sur le dÃ©pÃ´t git et lire le README. Il est possible dâ€™accÃ©der au dÃ©pÃ´t en cliquant ici Moteur de recherche GaÃ¯a. Puis aller sur LS3 pour cloner le projet.\nâš ï¸ Attention : il faut avoir les droits pour accÃ©der au dÃ©pÃ´t et Ãªtre dans le projet LS3. Si ce nâ€™est pas le cas, contactez lâ€™Ã©quipe GaÃ¯a sur Tchap ou mail.",
    "crumbs": [
      "Accueil",
      "Navigation",
      "Accueil"
    ]
  },
  {
    "objectID": "src/seminaire-dms/index.html#origine-du-projet",
    "href": "src/seminaire-dms/index.html#origine-du-projet",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Origine du projet",
    "text": "Origine du projet\n\nBesoin dâ€™un rÃ©fÃ©rentiel complet, stable, fiable, mis Ã  jour.\nFaciliter la gestion des adresses au sein du SSP.\nClients : RÃ©sil, GÃ©oloc, DMTRâ€¦\n\nGaÃ¯a : RÃ©fÃ©rentiel GÃ©ographique dâ€™Adresses avec Informations GÃ©olocalisantes.\n\nParler de lâ€™origine du projet, quand ca a Ã©tÃ© mis en place, comment, pqâ€¦"
  },
  {
    "objectID": "src/seminaire-dms/index.html#une-adresse",
    "href": "src/seminaire-dms/index.html#une-adresse",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Une adresse",
    "text": "Une adresse\n\n\n\n\n\n20 bis avenue de la marne 92049"
  },
  {
    "objectID": "src/seminaire-dms/index.html#gÃ©omÃ©trie-de-ladresse",
    "href": "src/seminaire-dms/index.html#gÃ©omÃ©trie-de-ladresse",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "GÃ©omÃ©trie de lâ€™adresse",
    "text": "GÃ©omÃ©trie de lâ€™adresse\nExemple: â€œ88 avenue verdier | 92049â€ reliÃ©e Ã  sa parcelle"
  },
  {
    "objectID": "src/seminaire-dms/index.html#le-rÃ©fÃ©rentiel-gaÃ¯a",
    "href": "src/seminaire-dms/index.html#le-rÃ©fÃ©rentiel-gaÃ¯a",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Le rÃ©fÃ©rentiel GaÃ¯a",
    "text": "Le rÃ©fÃ©rentiel GaÃ¯a\n\n\nAutres donnÃ©es disponibles (aspect gÃ©omÃ©trique des objets) :\n\nPour chaque adresse GaÃ¯a : point gps, lien parcelle.\n\nPour chaque commune GaÃ¯a : polygone."
  },
  {
    "objectID": "src/seminaire-dms/index.html#identifiants-gaÃ¯a",
    "href": "src/seminaire-dms/index.html#identifiants-gaÃ¯a",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Identifiants GaÃ¯a",
    "text": "Identifiants GaÃ¯a\nIdentifiant unique et stable pour assurer le suivi des objets dans le temps.\n\nTrois niveaux :\n\nIdentifiant adresse\nIdentifiant voie\nIdentifiant commune\n\n\nGestion des scissions et fusions de communes."
  },
  {
    "objectID": "src/seminaire-dms/index.html#construction-du-rÃ©fÃ©rentiel",
    "href": "src/seminaire-dms/index.html#construction-du-rÃ©fÃ©rentiel",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Construction du rÃ©fÃ©rentiel",
    "text": "Construction du rÃ©fÃ©rentiel\nSources fiables :\n\nMajic : Mise Ã  jour des informations cadastrales.\n\nBAN : Base Adresse Nationale.\n\nRCA : RÃ©fÃ©rentiel Commun dâ€™Adresses.\n\n\nAu moins une mise Ã  jour par trimestre (avec conservation des identifiants GaÃ¯a).\n\nUne mise Ã  jour :\n\nRÃ©cupÃ©rer la nouvelle base dâ€™une source donnÃ©es.\n\nIdentifier les adresses textuellement :\n\n\n\nLes adresses qui sont retrouvÃ©es sont alors modifiÃ©es si des nouveautÃ©s apparaissent.\n\nLes adresses non retrouvÃ©es entraÃ®nent la crÃ©ation de nouveaux objets GaÃ¯a.\nLâ€™Ã©tape dâ€™identification des adresses permet de ne pas Ã©craser les identifiants GaÃ¯a."
  },
  {
    "objectID": "src/seminaire-dms/index.html#dautres-donnÃ©es",
    "href": "src/seminaire-dms/index.html#dautres-donnÃ©es",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Dâ€™autres donnÃ©es",
    "text": "Dâ€™autres donnÃ©es\n\nPolygones du bÃ¢ti.\n\nPolygones Parcelles du cadastre.\n\nPolygones QPV, zonages infra, iris.\n\nPas dâ€™identifiant GaÃ¯a, donc pas de suivi dans le temps de ces objets."
  },
  {
    "objectID": "src/seminaire-dms/index.html#exemples-de-gÃ©omÃ©tries",
    "href": "src/seminaire-dms/index.html#exemples-de-gÃ©omÃ©tries",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Exemples de gÃ©omÃ©tries",
    "text": "Exemples de gÃ©omÃ©tries\nExemple de gÃ©omÃ©tries dâ€™adresses, parcelles et bÃ¢tis"
  },
  {
    "objectID": "src/seminaire-dms/index.html#quelques-mÃ©triques-sur-le-rÃ©fÃ©rentiel",
    "href": "src/seminaire-dms/index.html#quelques-mÃ©triques-sur-le-rÃ©fÃ©rentiel",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Quelques mÃ©triques sur le rÃ©fÃ©rentiel",
    "text": "Quelques mÃ©triques sur le rÃ©fÃ©rentiel\n\nNombre dâ€™adresses â‰ƒ 27 millions.\n\nNombre de voies â‰ƒ 3 millions."
  },
  {
    "objectID": "src/seminaire-dms/index.html#diffÃ©rents-besoins-au-sein-du-ssp",
    "href": "src/seminaire-dms/index.html#diffÃ©rents-besoins-au-sein-du-ssp",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "DiffÃ©rents besoins au sein du SSP",
    "text": "DiffÃ©rents besoins au sein du SSP\n\nRÃ©sil :\n\nIdentification le(s) adresse(s) des individus.\n\nRegroupement des adresses avec diffÃ©rents identifiants GaÃ¯a mais qui reprÃ©sentent le mÃªme lieu.\n\nGÃ©oloc : identification du rÃ©fÃ©rentiel GÃ©oloc et gÃ©nÃ©ration de leur nouveau rÃ©fÃ©rentiel.\n\nAutres utilisateurs possibles :\n\nIdentification des adresses sur les certificats de dÃ©cÃ¨s.\n\nIdentification des adresses de Sirus."
  },
  {
    "objectID": "src/seminaire-dms/index.html#besoin-didentification-des-adresses-textuelles",
    "href": "src/seminaire-dms/index.html#besoin-didentification-des-adresses-textuelles",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Besoin dâ€™identification des adresses textuelles",
    "text": "Besoin dâ€™identification des adresses textuelles\nTrouver lâ€™identifiant dâ€™adresse Ã  partir dâ€™un libellÃ© dâ€™adresse plus ou moins correcte.\n\nBesoin visiblement rÃ©current au sein du SSP.\n\nIndispensable pour construire et mettre Ã  jour le rÃ©fÃ©rentiel.\n\nIl faut donc un moteur de recherche âš™ï¸."
  },
  {
    "objectID": "src/seminaire-dms/index.html#adresses-Ã -retrouver-dans-gaÃ¯a",
    "href": "src/seminaire-dms/index.html#adresses-Ã -retrouver-dans-gaÃ¯a",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Adresses Ã  retrouver dans GaÃ¯a",
    "text": "Adresses Ã  retrouver dans GaÃ¯a\nExemple dâ€™adresses Ã  retrouver :\n\n\n\n\n\n\n\n\n\nAdresse Ã  retrouver\nCOG\nCode Postal\nLibellÃ© commune\n\n\n\n\n131, rue du fbg Bannier\n\n45000\nOrlÃ©ans\n\n\n0033 ave J. JaurÃ¨s\n92040\n\n\n\n\n\nAdresses dans GaÃ¯a :\n\n\n\nAdresse\nCOG\n\n\n\n\n131 rue du faubourg bannier\n45234\n\n\n33 avenue jean jaures\n92040\n\n\n\n\nCâ€™est pourquoi il faut un moteur de recherche âš™ï¸."
  },
  {
    "objectID": "src/seminaire-dms/index.html#un-moteur-de-recherche",
    "href": "src/seminaire-dms/index.html#un-moteur-de-recherche",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Un moteur de recherche âš™ï¸",
    "text": "Un moteur de recherche âš™ï¸\n\nGoogle : recherche par mot clÃ©.\n\nPour la recherche dâ€™adresse :\n\nGoogle Maps.\nAddok : moteur de recherche de la BAN."
  },
  {
    "objectID": "src/seminaire-dms/index.html#elasticsearch",
    "href": "src/seminaire-dms/index.html#elasticsearch",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "ElasticSearch",
    "text": "ElasticSearch\n\nCrÃ©Ã© en 2010 par Shay Bannon.\n\nMoteur âš™ï¸ utilisable en nâ€™importe quel langage de programmation (requÃªtes HTTP).\n\nFaire des recherches rapides sur tout type de donnÃ©es (textes, objets gÃ©omÃ©triquesâ€¦).\n\n\nPour trier et chercher les recettes de cuisine de sa femme psq il trouvait pas de moteur de recherche adaptÃ©."
  },
  {
    "objectID": "src/seminaire-dms/index.html#cest-quoi-concrÃ¨tement-elasticsearch",
    "href": "src/seminaire-dms/index.html#cest-quoi-concrÃ¨tement-elasticsearch",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Câ€™est quoi concrÃ¨tement ElasticSearch ?",
    "text": "Câ€™est quoi concrÃ¨tement ElasticSearch ?\n\nElasticSearch : logiciel pour lâ€™indexation et la recherche de donnÃ©es.\nUtilisation en pratique avec Python : packages elasticsearch et elasticsearch-dsl."
  },
  {
    "objectID": "src/seminaire-dms/index.html#pourquoi-elasticsearch-pour-la-recherche-textuelle",
    "href": "src/seminaire-dms/index.html#pourquoi-elasticsearch-pour-la-recherche-textuelle",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Pourquoi ElasticSearch pour la recherche textuelle ?",
    "text": "Pourquoi ElasticSearch pour la recherche textuelle ?\n\n\n\n\n\n\n\n\n\nCritÃ¨res\nElasticSearch\nSQL\nAddok\n\n\n\n\nRecherche de texte avancÃ©e\nâœ…\nâŒ\nâœ…\n\n\nPersonnalisation des recherches\nâœ…\nâŒ\nâŒ\n\n\nRapiditÃ©\nâœ…\nâœ…\nâœ…\n\n\nPrÃ©cision\nâœ…\nâŒ\nâš ï¸\n\n\nFacilitÃ© dâ€™implÃ©mentation\nâŒ\nâœ…\nâœ…\n\n\nMaintenance\nâš ï¸\nâœ…\nâŒ\n\n\n\n\nDonner explication addok"
  },
  {
    "objectID": "src/seminaire-dms/index.html#filtres",
    "href": "src/seminaire-dms/index.html#filtres",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Filtres",
    "text": "Filtres\n\n\nNormaliser le texte pour la comparaison.\n\nPour les donnÃ©es du rÃ©fÃ©rentiel ET pour les adresses recherchÃ©es."
  },
  {
    "objectID": "src/seminaire-dms/index.html#filtres-implÃ©mentÃ©s",
    "href": "src/seminaire-dms/index.html#filtres-implÃ©mentÃ©s",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Filtres implÃ©mentÃ©s",
    "text": "Filtres implÃ©mentÃ©s\n\nLowercase\n\nAsciifolding\n\nPonctuation\n\nSÃ©paration des nombres et lettres (ex : 1er â†’ 1 er)\n\nSuppression des espaces supplÃ©mentaires\n\nSuppression des â€œ0â€ devant les nombres (ex : 0033 â†’ 33)\n\nPrise en compte des synonymes (ex : ave = avenue, st = saint)"
  },
  {
    "objectID": "src/seminaire-dms/index.html#base-de-donnÃ©es-classique",
    "href": "src/seminaire-dms/index.html#base-de-donnÃ©es-classique",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Base de donnÃ©es classique",
    "text": "Base de donnÃ©es classique\nExemple\n\n\n\nidVoie\nnom de voie\n\n\n\n\nA\ndu general leclerc\n\n\nB\ndu general charles de gaulle\n\n\nC\ndu point du jour\n\n\nD\nverdier\n\n\nE\ndes cours"
  },
  {
    "objectID": "src/seminaire-dms/index.html#recherche-par-mot",
    "href": "src/seminaire-dms/index.html#recherche-par-mot",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Recherche par mot",
    "text": "Recherche par mot\nPour chaque nom de voie du rÃ©fÃ©rentiel, compter le nombre de mots qui matchent ğŸ¯ avec les mots de lâ€™adresse recherchÃ©e.\n\nExemple : score avec tokenizer â€œmotâ€ de â€œ88 avenue du general charles de gaulleâ€\n\n\n\nidVoie\nnom de voie\nscore\n\n\n\n\nA\ndu general leclerc\n2\n\n\nB\ndu general charles de gaulle\n5\n\n\nC\ndu point du jour\n2\n\n\nD\nverdier\n0\n\n\nE\ndes cours\n0\n\n\n\n\n\nUn match câ€™est chercher si une sous chaine du nom de voie, ici un mot, est incluse dans lâ€™adresse recherchÃ©e.\n\nRecherche par groupes de caractÃ¨res Ã©galement possible, abordÃ©e dans la suite."
  },
  {
    "objectID": "src/seminaire-dms/index.html#score-avec-tokenizer-mot",
    "href": "src/seminaire-dms/index.html#score-avec-tokenizer-mot",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Score avec tokenizer â€œmotâ€",
    "text": "Score avec tokenizer â€œmotâ€\nTokenizer = faÃ§on de dÃ©couper le texte recherchÃ© et ciblÃ©.\n\nPour retourner la voie la plus pertinente, on construit un score pour chaque voie : \\[\nscore_{voie} = \\sum_{\\text{âˆ€m} \\in \\text{M}} {nb\\_occurrence}_m\n\\]\nm = mot.\nM = ensemble des mots de lâ€™adresse recherchÃ©e.\nDans une grande base de donnÃ©es, câ€™est extrÃªmement long."
  },
  {
    "objectID": "src/seminaire-dms/index.html#index-inversÃ©-mot",
    "href": "src/seminaire-dms/index.html#index-inversÃ©-mot",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Index inversÃ© mot",
    "text": "Index inversÃ© mot\nExemple\n\n\n\n\n\n\nidVoie\n\n\nnom de voie\n\n\n\n\n\n\nA\n\n\ndu general leclerc\n\n\n\n\nB\n\n\ndu general charles de gaulle\n\n\n\n\nC\n\n\ndu point du jour\n\n\n\n\nD\n\n\nverdier\n\n\n\n\nE\n\n\ndes cours\n\n\n\n\n\n\n\n\n\n\n\n\nmot\n\n\noccurrences\n\n\n\n\n\n\ngeneral\n\n\n{â€œAâ€: 1, â€œBâ€: 1}\n\n\n\n\njour\n\n\n{â€œCâ€: 1}\n\n\n\n\ndu\n\n\n{â€œAâ€: 1, â€œBâ€: 1, â€œCâ€: 2}\n\n\n\n\ncours\n\n\n{â€œEâ€: 1}\n\n\n\n\nâ€¦\n\n\nâ€¦\n\n\n\n\n\nComptage direct âš¡ des occurrences de chaque mot de la base par idVoie.\n\n\nFaire un index inversÃ© par mot, câ€™est rÃ©cupÃ©rer tous les mots des noms de voie dans le rÃ©fÃ©rentiel et on les aplati dans une colonne.\n\nIl y a autant de lignes quâ€™il y a de mots diffÃ©rents dans les noms de voie du rÃ©fÃ©rentiel. Les mots les plus frÃ©quents seront ceux qui ont le plus dâ€™occurences.\n\nNous obtenons directement le comptage de chaque mot par idVoie, pour tous les mots prÃ©sents dans les noms de voie du rÃ©fÃ©rentiel.\n\nLâ€™index inversÃ© est fait en amont des requetes."
  },
  {
    "objectID": "src/seminaire-dms/index.html#fuzziness",
    "href": "src/seminaire-dms/index.html#fuzziness",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Fuzziness",
    "text": "Fuzziness\nContourner les petites fautes dâ€™orthographes : fuzziness.\nPour matcher ğŸ¯ deux mots avec une fuzziness de niveau 1 = corriger lâ€™un des mots :\n\nAjout dâ€™une lettre. Ex: â€œverdiierâ€\n\nSuppression dâ€™une lettre. Ex: â€œverdieâ€\n\nRemplacement dâ€™une lettre. Ex: â€œverfierâ€\n\nÃ‰changer deux lettres de place. Ex: â€œevrdierâ€\n\nIl est possible de comparer deux textes, deux n-grams ou nâ€™importe quel autre groupe de caractÃ¨res."
  },
  {
    "objectID": "src/seminaire-dms/index.html#recherche-par-n-grams-de-caractÃ¨res",
    "href": "src/seminaire-dms/index.html#recherche-par-n-grams-de-caractÃ¨res",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Recherche par n-grams de caractÃ¨res",
    "text": "Recherche par n-grams de caractÃ¨res\nPrendre en compte les correspondances partielles : chaque mot est dÃ©coupÃ© en sous-chaÃ®nes de n caractÃ¨res consÃ©cutifs.\n\nExemple de dÃ©coupage en 3-grams de caractÃ¨res du texte â€œavenue verdierâ€ :\nave, ven, enu, nue, ver, erd, rdi, die, ier\n\nSi un mot est infÃ©rieur Ã  la taille n, il nâ€™aura pas de dÃ©coupage en n-grams â†’ pas prÃ©sent dans lâ€™index inversÃ© n-gram."
  },
  {
    "objectID": "src/seminaire-dms/index.html#index-inversÃ©-3-grams",
    "href": "src/seminaire-dms/index.html#index-inversÃ©-3-grams",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Index inversÃ© 3-grams",
    "text": "Index inversÃ© 3-grams\nExemple\n\n\n\n\n\n\nidVoie\n\n\nnom de voie\n\n\n\n\n\n\nA\n\n\ndu general leclerc\n\n\n\n\nB\n\n\ndu general charles de gaulle\n\n\n\n\nC\n\n\ndu point du jour\n\n\n\n\nD\n\n\nverdier\n\n\n\n\nE\n\n\ndes cours\n\n\n\n\n\n\n\n\n\n\n\n\n3-gram\n\n\noccurrences\n\n\n\n\n\n\ngen\n\n\n{â€œAâ€: 1, â€œBâ€: 1}\n\n\n\n\ncha\n\n\n{â€œBâ€: 1}\n\n\n\n\nour\n\n\n{â€œCâ€: 1, â€œEâ€: 1}\n\n\n\n\noin\n\n\n{â€œCâ€: 1}\n\n\n\n\nâ€¦\n\n\nâ€¦\n\n\n\n\n\n\n\nIl y a autant de lignes quâ€™il ya de trigrams diffÃ©rents dans les noms de voie du rÃ©fÃ©rentiel.\n\nSi un mot est infÃ©rieur Ã  la taille n=3, il ne sera pas pris en compte. Par exemple : du gÃ©nÃ©ral de gaules, â€œduâ€ et â€œdeâ€ nâ€™apparaÃ®tront pas dans lâ€™index et donc ne seront pas pris en compte dans les matchs trigrams."
  },
  {
    "objectID": "src/seminaire-dms/index.html#score-avec-tokenizer-n-grams",
    "href": "src/seminaire-dms/index.html#score-avec-tokenizer-n-grams",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Score avec tokenizer â€œn-gramsâ€",
    "text": "Score avec tokenizer â€œn-gramsâ€\nScore pour chaque voie : \\[\nscore_{voie} = \\sum_{\\text{âˆ€ngram} \\in \\text{N}} {nb\\_occurrence}_{ngram}\n\\]\nN = ensemble des n-grams de lâ€™adresse recherchÃ©e."
  },
  {
    "objectID": "src/seminaire-dms/index.html#limites-des-n-grams",
    "href": "src/seminaire-dms/index.html#limites-des-n-grams",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Limites des n-grams",
    "text": "Limites des n-grams\n\\[\n\\downarrow \\text{taille n-grams}\n\\Rightarrow \\text{taille index inversÃ©} \\uparrow\n\\Rightarrow \\text{temps de recherche} \\uparrow\n\\]\n\nLimitation Ã  nâˆˆ{3,4,5} pour notre cas.\n\nTests effectuÃ©s pour choisir ces valeurs, en fonction de la prÃ©cision et la rapiditÃ© des requÃªtes."
  },
  {
    "objectID": "src/seminaire-dms/index.html#boost",
    "href": "src/seminaire-dms/index.html#boost",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Boost",
    "text": "Boost\n\nOn peut donner plus ou moins dâ€™importance aux diffÃ©rents matchs ğŸ¯.\n\nChaque occurrence est multipliÃ©e par un facteur, appelÃ© boost, qui dÃ©pend du niveau de match ğŸ¯."
  },
  {
    "objectID": "src/seminaire-dms/index.html#score-global",
    "href": "src/seminaire-dms/index.html#score-global",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Score global",
    "text": "Score global\nLe score global va donc combiner la somme des matchs ğŸ¯ au niveau :\n\nmot.\n\nn-grams.\n\nfuzziness.\n\nEt booster en fonction de lâ€™importance quâ€™on leur donne."
  },
  {
    "objectID": "src/seminaire-dms/index.html#faire-des-recherches",
    "href": "src/seminaire-dms/index.html#faire-des-recherches",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Faire des recherches ğŸ”",
    "text": "Faire des recherches ğŸ”\nRequÃªte ğŸ” pour retrouver la voie :\n\nMatch ğŸ¯ nom de voie entier sans dÃ©coupage avec fuzzi 1, boost 200. Ex : â€œ3 rue du genral de gaulleâ€ âŠƒ â€œdu general de gaulleâ€.\n\nMatch ğŸ¯ chaque mot du nom de voie avec fuzzi 1, boost 15.\n\nMatch ğŸ¯ chaque mot du type de voie avec fuzzi 1, boost 5.\n\nMatch ğŸ¯ chaque 3 Ã  5-grams du nom de voie, boost 1.\n\nÃ€ chaque fois quâ€™une sous-chaÃ®ne valide lâ€™une de ces conditions, le score va â‡¡ en fonction du boost associÃ©.\n\n\nOn match Ã  chaque 3-grams, exemple avec verdier.\n\nLes ngrams câ€™est notre dernier recours, on va retourner comme voie plus pertinente les match sur nom de voie complet et sur token mais ngrams câ€™est notre roue de secours."
  },
  {
    "objectID": "src/seminaire-dms/index.html#retour-sur-le-score-global",
    "href": "src/seminaire-dms/index.html#retour-sur-le-score-global",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Retour sur le score global",
    "text": "Retour sur le score global\n\\[\nscore_{voie} = \\sum_{\\text{âˆ€n} \\in \\text{N}} \\sum_{\\text{âˆ€t} \\in \\text{n}} boost_{n}*{nb\\_occurrence}_{t}\n\\]\nN = ensemble des niveaux (niveau mot, niveau fuzziâ€¦).\nn = niveau.\nt = token, sous-chaÃ®ne (un mot, un 3-gramsâ€¦)."
  },
  {
    "objectID": "src/seminaire-dms/index.html#algorithme-didentification-dadresses-1",
    "href": "src/seminaire-dms/index.html#algorithme-didentification-dadresses-1",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Algorithme dâ€™identification dâ€™adresses",
    "text": "Algorithme dâ€™identification dâ€™adresses\n\nPrends en entrÃ©e un libellÃ© dâ€™adresse et un COG, ou Ã  dÃ©faut, un code postal + libellÃ© commune.\n\nRetourne :\n\nle(s) identifiant(s) GaÃ¯a retrouvÃ©(s).\n\nune indicatrice sur la qualitÃ© de lâ€™identification (0 Ã  10).\n\nun ratio qui mesure lâ€™Ã©cart entre la 1Ã¨re et la 2Ã¨me voie la plus pertinente retournÃ©es par Elastic (0 Ã  1)."
  },
  {
    "objectID": "src/seminaire-dms/index.html#schÃ©ma-algorithme-didentification",
    "href": "src/seminaire-dms/index.html#schÃ©ma-algorithme-didentification",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "SchÃ©ma algorithme dâ€™identification",
    "text": "SchÃ©ma algorithme dâ€™identification\n\n\n\nEntre chaque requÃªte Elastic, il y a des Ã©tapes de validation du rÃ©sultat ES.\n\nIdentification stricte : une recherche lâ€™adresse comme un appariement direct avec notre rÃ©fÃ©rentiel GaÃ¯a, mais on applique les filtres en amont.\n\nEn moyenne, sur une base de donnÃ©es dâ€™adresses non normalisÃ©es, il y a 30% des adresses qui passent Ã  la premiÃ¨re Ã©tape de lâ€™identification. Cette identification stricte permet donc dâ€™accÃ©lerer le processus, car elle prend 6 fois moins de temps que les requÃªtes floues sur le nom de voie.\n\nComme les bases de donnÃ©es qui alimentent notre rÃ©fÃ©rentiel sont plutÃ´t normalisÃ©es, cela accÃ©lÃ¨re dâ€™autant plus notre processus dâ€™identification."
  },
  {
    "objectID": "src/seminaire-dms/index.html#indicatrice-qualitÃ©",
    "href": "src/seminaire-dms/index.html#indicatrice-qualitÃ©",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Indicatrice qualitÃ©",
    "text": "Indicatrice qualitÃ©\n\nDÃ©pend du pourcentage de 3-grams de la voie du rÃ©fÃ©rentiel âŠ‚ lâ€™adresse recherchÃ©e.\nCalcul non rÃ©alisable avec Elastic, donc effectuÃ© post requÃªte.\n\n\n\n\nVoie qualifiÃ©e de\nPourcentage de 3-grams\n\n\n\n\nsÃ»re\nâ‰¥ 65%\n\n\npeu douteuse\n35% â‰¤ x &lt; 65%\n\n\ndouteuse\n10% â‰¤ x &lt; 35%\n\n\nnon retrouvÃ©e\n&lt; 10%\n\n\n\nExemple : 80% des 3-grams de â€œverdierâ€ dans â€œ88 avenue verdieâ€.\n\n\nLe trigram â€œierâ€ nâ€™est jamais matchÃ©\n\nverdier : 5 trigrams\n\n4 trigrams retrouvÃ©s dans 88 avenue verdier\n\n4*100/5 = 80\nCes valeurs nâ€™ont pas Ã©tÃ© choisies aux hasard, elles ont Ã©tÃ© calculÃ©es grÃ¢ce au jeu de test que nous allons vous prÃ©senter ensuite. Et nous avons regardÃ© la courbe PrÃ©cision-Rappel.\nPrÃ©cision = Vrais positifs/ positifs (vp + fp)\nRappel = Vrais positifs / Bons prÃ©dits (vp + vn)"
  },
  {
    "objectID": "src/seminaire-dms/index.html#valeurs-de-lindicatrice-qualitÃ©",
    "href": "src/seminaire-dms/index.html#valeurs-de-lindicatrice-qualitÃ©",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Valeurs de lâ€™indicatrice qualitÃ©",
    "text": "Valeurs de lâ€™indicatrice qualitÃ©\n\n\n\nValeur\nidGaÃ¯a maximum retrouvÃ©\n\n\n\n\n6 Ã  10\nidAdresse\n\n\n3 Ã  5\nidVoie\n\n\n2\nidCommune\n\n\n0 Ã  1\nAucun"
  },
  {
    "objectID": "src/seminaire-dms/index.html#distance-entre-la-1Ã¨re-et-la-2Ã¨me-voie-la-plus-pertinente",
    "href": "src/seminaire-dms/index.html#distance-entre-la-1Ã¨re-et-la-2Ã¨me-voie-la-plus-pertinente",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Distance entre la 1Ã¨re et la 2Ã¨me voie la plus pertinente",
    "text": "Distance entre la 1Ã¨re et la 2Ã¨me voie la plus pertinente\n\\[\n\\text{ratio} = 1 - \\frac{R_2}{R_1}\n\\]\nR1 = score Elastic de la 1Ã¨re voie la plus pertinente (voie retournÃ©e).\nR2 = score Elastic de la 2Ã¨me voie la plus pertinente.\nRatio â†’ 1 â‡” le rÃ©sultat retournÃ© est loin de la 2Ã¨me proposition."
  },
  {
    "objectID": "src/seminaire-dms/index.html#constitution-dun-jeu-de-test",
    "href": "src/seminaire-dms/index.html#constitution-dun-jeu-de-test",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Constitution dâ€™un jeu de test",
    "text": "Constitution dâ€™un jeu de test\n\nIdÃ©e : avoir des adresses avec des variations textuelles et leur idGaÃ¯aAdresse associÃ© (vÃ©ritÃ©).\n\nLe jeu de test est une suite dâ€™appariements de sources de donnÃ©es :\n\nPASRAU : PrÃ©lÃ¨vement Ã€ la Source sur les Revenus AUtres.\n\nTSSAL : Base tous salariÃ©s, issue de la dÃ©claration sociale nominative.\n\nFidÃ©li : FIchiers DÃ‰mographiques sur les Logements et les Individus.\n\n\nValidation post-appariements des paires adresse non normalisÃ©e + idGaÃ¯aAdresse."
  },
  {
    "objectID": "src/seminaire-dms/index.html#schÃ©ma-appariements-jeu-de-test",
    "href": "src/seminaire-dms/index.html#schÃ©ma-appariements-jeu-de-test",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "SchÃ©ma appariements jeu de test",
    "text": "SchÃ©ma appariements jeu de test\n\n\n\nPASRAU : Ce sont des donnÃ©es administratives gÃ©nÃ©rÃ©es par le prÃ©lÃ¨vement Ã  la source sur les retraites et dâ€™autres revenus (mais pas les salaires).\nAdresses du PASRAU et Tous SalariÃ©s (TTSAL) avec le CSNS de lâ€™individu connu pour chaque adresse.\n\nGrÃ¢ce aux CSNS des individus FidÃ©li 2022, obtention de lâ€™identifiant Majic de ces adresses.\nAvec lâ€™identifiant Majic des adresses, conservÃ© dans le rÃ©fÃ©rentiel GaÃ¯a, on retrouve lâ€™idGaÃ¯aAdresse.\n\nLes adresses (PASRAU, TSSAL) sont comparÃ©es aux adresses du rÃ©fÃ©rentiel, et seules les paires considÃ©rÃ©es comme identiques sont conservÃ©es."
  },
  {
    "objectID": "src/seminaire-dms/index.html#Ã©valuation-de-lalgorithme-didentification",
    "href": "src/seminaire-dms/index.html#Ã©valuation-de-lalgorithme-didentification",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Ã‰valuation de lâ€™algorithme dâ€™identification",
    "text": "Ã‰valuation de lâ€™algorithme dâ€™identification\nPour 100 000 adresses issues du jeu de test sur tout le territoire franÃ§ais :\n\n\n\n\n\n\n\n\n\n\nAdresse trouvÃ©e\nVoie trouvÃ©e\nCommune trouvÃ©e/rien trouvÃ©\n\n\n\n\nPourcentage\n86,0%\n99,5%\n0,5%\n\n\nPrÃ©cision\n0.94\n0.94\nx\n\n\n\nAppariement direct avec filtres entre adresses Ã  retrouver et rÃ©fÃ©rentiel GaÃ¯a : 30% dâ€™identification Ã  lâ€™adresse.\n\n\nPrÃ©cision = Vrais positifs/ positifs (vp + fp)\nA titre de comparaison, un appariement direct entre les adresses Ã  retrouver et le rÃ©fÃ©rentiel GaÃ¯a donnerait 30% dâ€™identification Ã  condition que les filtres prÃ©sentÃ©s prÃ©cÃ©demment soient appliquÃ©s."
  },
  {
    "objectID": "src/seminaire-dms/index.html#rapiditÃ©-de-lalgorithme",
    "href": "src/seminaire-dms/index.html#rapiditÃ©-de-lalgorithme",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "RapiditÃ© de lâ€™algorithme",
    "text": "RapiditÃ© de lâ€™algorithme\n\n500 adresses en 2 secondes.\n\nIdentification de gros paquets dâ€™adresses : 1 million dâ€™adresses en 50 minutes."
  },
  {
    "objectID": "src/seminaire-dms/index.html#limites",
    "href": "src/seminaire-dms/index.html#limites",
    "title": "Identification dâ€™adresses avec ElasticSearch",
    "section": "Limites",
    "text": "Limites\n\nCompÃ©tences requises pour le dÃ©veloppement et la maintenance du moteur ElasticSearch.\n\nMoteur crÃ©Ã© par lâ€™EPS en Python, rÃ©Ã©crit en Java par lâ€™EPI.\n\nLes travaux ont Ã©tÃ© effectuÃ©s sur un rÃ©fÃ©rentiel contenant des erreurs/doublons â†’ entrave les mÃ©triques qualitÃ©."
  }
]